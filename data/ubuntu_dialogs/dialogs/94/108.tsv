2010-03-09T18:36:00.000Z	ubuntu_		hello guys. pls help me out with this one: I formated my "Home" partition, but now I cannot boot again. Is there a way to restore my backup without reinstalling the OS?
2010-03-09T18:38:00.000Z	airtonix	ubuntu_	could you tell us about your "backup" , how it was done
2010-03-09T18:39:00.000Z	airtonix	ubuntu_	ok so i think the first thing to do would be to work out the user id number that owns the files on your backup.
2010-03-09T18:40:00.000Z	airtonix	ubuntu_	(theoretically this should be the user id number of the user you have for the installation you have running sans home folder.)
2010-03-09T18:40:00.000Z	airtonix	ubuntu_	what is the status of the 'home' partition at this point ?
2010-03-09T18:41:00.000Z	airtonix	ubuntu_	how did you attempt to restore it ?
2010-03-09T18:41:00.000Z	airtonix	ubuntu_	and you did this with a live cd i presume ?
2010-03-09T18:43:00.000Z	airtonix	ubuntu_	ok from my limited experience with this scenario i believe the issue is that the user id doesn not match. and that there are several inconsistancies with the current home partition... does fstab specify that /home is to be mounted on your 'home' partition ?
2010-03-09T18:45:00.000Z	airtonix	ubuntu_	1) get a list of the partitions with : sudo fdisk -l and identify the partition that you recently formatted.note down the address which would like "/dev/something" 2) check the /etc/fstab file... you can do this with gksudo gedit /etc/fstab and look at the line which talks about mounting /home...does it point to the same address you found in step one ?
2010-03-09T18:48:00.000Z	airtonix	ubuntu_	also when typing messages here could you prefix it with the nick of the person you are talking to so that their client takes care of notifications...makes it easier to track conversations in a large room.
2010-03-09T18:50:00.000Z	ubuntu_	airtonix	i think it's ok
2010-03-09T18:50:00.000Z	ubuntu_	airtonix	the fstab says sdb5 is home and i think thats true,,,
2010-03-09T18:51:00.000Z	airtonix	ubuntu_	so fstab has /home setup to mount on your desired partition ?
2010-03-09T18:51:00.000Z	airtonix	ubuntu_	so far so good.
2010-03-09T18:51:00.000Z	airtonix	ubuntu_	so next step is the check the user id numbers
2010-03-09T18:51:00.000Z	ubuntu_	airtonix	there was no reason for it to change...
2010-03-09T18:51:00.000Z	airtonix	ubuntu_	of course... but we all need to be 'on the same page' just so there is no misunderstandings
2010-03-09T18:52:00.000Z	ubuntu_	airtonix	ok what i do next?
2010-03-09T18:52:00.000Z	airtonix	ubuntu_	i assume you are currently using the live cd ?
2010-03-09T18:52:00.000Z	ubuntu_	airtonix	yes
2010-03-09T18:53:00.000Z	airtonix	ubuntu_	and that you formatted your desired home partition from the live cd... which means that the home partition is owned by the live cd user and has the live cd users id number... not the id number that your 'real' user had.
2010-03-09T18:54:00.000Z	ubuntu_	airtonix	yes
2010-03-09T18:55:00.000Z	airtonix	ubuntu_	ok so you've already restored the backups ?
2010-03-09T18:55:00.000Z	ubuntu_	airtonix	as i said before yes
2010-03-09T18:55:00.000Z	airtonix	ubuntu_	because the first thing you'll need to do is change the owner of the /home directory to the root user of your real system... but to do that you need chown it by userid not username...
2010-03-09T18:56:00.000Z	ubuntu_	airtonix	ok, how i am supposed to do that/
2010-03-09T18:56:00.000Z	airtonix	ubuntu_	and when i say /home i don't mena your home folder (/home/blah) i mean the /home... (which means this is easier if you just clean the partition again.
2010-03-09T18:57:00.000Z	ubuntu_	airtonix	so i need to reformat it?
2010-03-09T18:57:00.000Z	airtonix	ubuntu_	or just wipe it...which ever you find easier...make sure you still have that backup
2010-03-09T18:58:00.000Z	ubuntu_	airtonix	ok, I will erase everything on the /home partition, correct?
2010-03-09T18:58:00.000Z	airtonix	ubuntu_	yep
2010-03-09T18:59:00.000Z	ubuntu_	airtonix	ok and now?
2010-03-09T18:59:00.000Z	ubuntu_	airtonix	now the /home partition is clean
2010-03-09T18:59:00.000Z	airtonix	ubuntu_	create a folder called 'home'
2010-03-09T18:59:00.000Z	ubuntu_	airtonix	where?
2010-03-09T18:59:00.000Z	airtonix	ubuntu_	on the home partition i think
2010-03-09T18:59:00.000Z	ubuntu_	airtonix	did it
2010-03-09T19:00:00.000Z	airtonix	ubuntu_	ok one sec i'll check some syntax
2010-03-09T19:02:00.000Z	airtonix	ubuntu_	your real root users id number should be 0 in pretty much all cases...
2010-03-09T19:02:00.000Z	airtonix	ubuntu_	i assume you have your home backup on an external hardrive ?
2010-03-09T19:02:00.000Z	ubuntu_	airtonix	no on another partition of internal hd
2010-03-09T19:03:00.000Z	ubuntu_	airtonix	i created the "home" folder in /home as root.is this ok?
2010-03-09T19:03:00.000Z	airtonix	ubuntu_	yep i think this is the goal...
2010-03-09T19:04:00.000Z	ubuntu_	airtonix	ok what i do next?
2010-03-09T19:04:00.000Z	airtonix	ubuntu_	we need to get the uid of your real user as you would be normally without the livecd... if you use this command you should be able to get it : ls -n /path/to/your/home/backup
2010-03-09T19:05:00.000Z	airtonix	ubuntu_	the uid will be the 3rd coloumn the 4th coloumn should be the gid of that user
2010-03-09T19:10:00.000Z	ubuntu_	airtonix	http://pastebin.com/PYcs4msd
2010-03-09T19:12:00.000Z	airtonix	ubuntu_	hmm and you made that backup via a command such as : cp /home /media/MyFiles ?
2010-03-09T19:12:00.000Z	ubuntu_	airtonix	no through dolphin
2010-03-09T19:12:00.000Z	airtonix	ubuntu_	ah so you dragged the /home folder into your backup drive ?
2010-03-09T19:14:00.000Z	ubuntu_	airtonix	how can i fix it?
2010-03-09T19:15:00.000Z	airtonix	ubuntu_	i dont think we need the home folder we created on your home partition... im thinking just copy that nikolas folder on there. (which is probably what you did in the first place )
2010-03-09T19:15:00.000Z	ubuntu_	airtonix	yes i did and it didn't work. is there a way i can fix it please?
2010-03-09T19:16:00.000Z	airtonix	ubuntu_	but you'd still need to make sure that the uid of the folders you copy have the uid of the nikolas user on the system
2010-03-09T19:16:00.000Z	ubuntu_	airtonix	can you please guide me through that?
2010-03-09T19:19:00.000Z	airtonix	ubuntu_	try this to find the uid of your user on the system : cat /etc/passwd | grep nikolas
2010-03-09T19:19:00.000Z	airtonix	ubuntu_	assuming you have the root partition mounted
2010-03-09T19:20:00.000Z	airtonix	ubuntu_	if you don't have the root partition of your real system mounted then that command wont return anything... i suggest mounting it on /media/oldroot then running : cat /media/oldroot/etc/passwd | grep nikolas
2010-03-09T19:22:00.000Z	airtonix	ubuntu_	you should get a line like : USERNAME:x:1000:1000:YOURNAME,,,:/home/USERNAME:/bin/bash (all captials words replaced with your username)
2010-03-09T19:22:00.000Z	ubuntu_	airtonix	http://pastebin.com/X5iskCJx
2010-03-09T19:22:00.000Z	ubuntu_	airtonix	now what?
2010-03-09T19:23:00.000Z	airtonix	ubuntu_	ok so in your home partition is there only your users folder? or is there the lost+found folder too ?
2010-03-09T19:24:00.000Z	ubuntu_	airtonix	the lost + found too
2010-03-09T19:24:00.000Z	airtonix	ubuntu_	try removing that as root maybe
2010-03-09T19:24:00.000Z	ubuntu_	airtonix	i have already removed both as you told me to do bedore
2010-03-09T19:25:00.000Z	ubuntu_	airtonix	so my /home partition is empty now
2010-03-09T19:25:00.000Z	airtonix	ubuntu_	ah ok cp the nikolas folder from your backup to the home partition
2010-03-09T19:26:00.000Z	ubuntu_	airtonix	in the /home/home or just in /home ?
2010-03-09T19:26:00.000Z	airtonix	ubuntu_	in /home
2010-03-09T19:27:00.000Z	ubuntu_	airtonix	it s copying.it will take for a while, its several gb.what i do next//
2010-03-09T19:28:00.000Z	airtonix	ubuntu_	nothing :) maybe have a read of this page http://www.psychocats.net/ubuntu/separatehome
2010-03-09T19:28:00.000Z	ubuntu_	airtonix	we are doing again what i already had done from the begining and didn't work. that was what i did at the first place
2010-03-09T19:29:00.000Z	airtonix	ubuntu_	the section "What if it doesn't work?" seems relevant
2010-03-09T19:29:00.000Z	ubuntu_	airtonix	as I said before i was getting an error message while booting saying that home cannot be mounted
2010-03-09T19:30:00.000Z	airtonix	ubuntu_	did you format it with the same filesystem as it was previously ?
2010-03-09T19:31:00.000Z	ubuntu_	airtonix	before ate the begining t was ext3 that later was converted into ext4 without formating.now i formated it in ext4
2010-03-09T19:32:00.000Z	airtonix	ubuntu_	this might be the issue maybe ? fstab expects it to be ext3 still ?
2010-03-09T19:33:00.000Z	airtonix	ubuntu_	check what filesystem  /etc/fstab specifies for the /home
2010-03-09T19:33:00.000Z	ubuntu_	airtonix	http://pastebin.com/gFh43Aww
2010-03-09T19:34:00.000Z	airtonix	ubuntu_	ah ok, try replacing that uuid with /dev/sdb5
2010-03-09T19:34:00.000Z	ubuntu_	airtonix	where?
2010-03-09T19:34:00.000Z	airtonix	ubuntu_	unless you know how to generate a valid uuid from the new /home partition ?
2010-03-09T19:35:00.000Z	ubuntu_	airtonix	no i dont.can you please throw on pastebin how fstab should be?
2010-03-09T19:35:00.000Z	airtonix	ubuntu_	ok
2010-03-09T19:35:00.000Z	airtonix	ubuntu_	i assume /dev/sdb5 is your home partition ?
2010-03-09T19:35:00.000Z	ubuntu_	airtonix	yes
2010-03-09T19:36:00.000Z	airtonix	ubuntu_	before you make these changes, do a backup of /etc/fstab : cp /etc/fstab /etc/fstab_bak
2010-03-09T19:36:00.000Z	ubuntu_	airtonix	ok
2010-03-09T19:36:00.000Z	airtonix	ubuntu_	http://pastebin.com/5NSLC8Mx
2010-03-09T19:38:00.000Z	airtonix	ubuntu_	give that a shot see if it works for you
2010-03-09T19:39:00.000Z	ubuntu_	airtonix	i ll wait for the files to complete cpying and then reboot.
2010-03-09T19:40:00.000Z	ubuntu_	airtonix	but the only thing we actually changed was fstab. could fstab be the problem?
2010-03-09T19:40:00.000Z	airtonix	ubuntu_	i hope so
2010-03-09T19:40:00.000Z	ubuntu_	airtonix	i hope i works, orelse i ll be back in a whiiie... tnx anyway
